<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="theme-color" content="#007bff">
    <title>Forum - Connect & Share</title>
    <link rel="stylesheet" href="css/styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <!-- Navigation Header -->
    <header class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <i class="fas fa-comments"></i>
                <span>Forum</span>
            </div>

            <!-- Mobile Menu Toggle -->
            <button class="mobile-menu-toggle" id="mobileMenuToggle" style="display: none;">
                <i class="fas fa-bars"></i>
            </button>
            


            <!-- Search Bar in Navbar -->
            <div class="nav-search">
                <div class="search-box">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" id="searchInput" placeholder="Search posts..." class="search-input">
                    <button id="clearSearchBtn" class="clear-search-btn" style="display: none;">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div id="searchResults" class="search-results-dropdown" style="display: none;">
                    <div class="search-info">
                        <span id="searchResultsCount">0</span> results for "<span id="searchQuery"></span>"
                        <button id="clearSearchResults" class="btn btn-sm btn-outline">Clear</button>
                    </div>
                </div>
            </div>

            <div class="nav-actions">
                <div class="user-menu" id="userMenu" style="display: none;">
                    <button class="btn btn-primary" id="createPostBtn">
                        <i class="fas fa-plus"></i> New Post
                    </button>
                    <div class="user-profile">
                        <span id="usernameDisplay"></span>
                        <button class="btn btn-secondary" id="logoutBtn">
                            <i class="fas fa-sign-out-alt"></i> Logout
                        </button>
                    </div>
                </div>
                
                <div class="auth-menu" id="authMenu">
                    <button class="btn btn-outline" id="loginBtn">Login</button>
                    <button class="btn btn-primary" id="registerBtn">Register</button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Home Page -->
        <div id="homePage" class="page active">
            <div class="container">
                <div class="content-grid">
                    <!-- Left Navigation Sidebar -->
                    <aside class="left-sidebar">
                        <nav class="nav-buttons">
                            <button class="nav-btn active" data-view="home">
                                <i class="fas fa-home"></i>
                                <span>Home</span>
                            </button>
                            <button class="nav-btn" data-view="my-posts" id="myPostsNavBtn" style="display: none;">
                                <i class="fas fa-user-edit"></i>
                                <span>My Posts</span>
                            </button>
                            <button class="nav-btn" data-view="liked-posts" id="likedPostsNavBtn" style="display: none;">
                                <i class="fas fa-heart"></i>
                                <span>Liked Posts</span>
                            </button>
                            <button class="nav-btn" data-view="trending">
                                <i class="fas fa-fire"></i>
                                <span>Trending</span>
                            </button>
                            <button class="nav-btn" data-view="profile" id="profileNavBtn" style="display: none;">
                                <i class="fas fa-user"></i>
                                <span>Profile</span>
                            </button>
                        </nav>
                    </aside>

                    <!-- Main Content Area -->
                    <main class="main-content-area">
                        <!-- Posts Feed -->
                        <section class="posts-feed active" id="postsSection">
                        <div class="feed-header">
                            <h2>Latest Posts</h2>
                            <div class="feed-filters">
                                <button class="filter-btn active" data-filter="all">All Posts</button>
                                <button class="filter-btn" data-filter="my-posts" id="myPostsFilter" style="display: none;">My Posts</button>
                                <button class="filter-btn" data-filter="liked" id="likedPostsFilter" style="display: none;">Liked Posts</button>
                            </div>
                        </div>
                        
                        <div id="postsContainer" class="posts-container">
                            <!-- Posts will be loaded here -->
                        </div>
                        
                        <div class="loading" id="loadingPosts" style="display: none;">
                            <i class="fas fa-spinner fa-spin"></i> Loading posts...
                        </div>
                    </section>

                    <!-- Profile View -->
                    <section class="profile-view" id="profileSection">
                        <div class="profile-header">
                            <div class="profile-avatar" id="profileAvatar">
                                <!-- Avatar initials will be inserted here -->
                            </div>
                            <div class="profile-info">
                                <h2 id="profileUsername">Loading...</h2>
                                <div class="profile-email" id="profileEmail">Loading...</div>
                                <div class="profile-joined" id="profileJoined">Member since: Loading...</div>
                            </div>
                        </div>

                        <div class="profile-stats">
                            <div class="profile-stat">
                                <span class="profile-stat-number" id="userPostsCount">0</span>
                                <span class="profile-stat-label">Posts Created</span>
                            </div>
                            <div class="profile-stat">
                                <span class="profile-stat-number" id="userLikesCount">0</span>
                                <span class="profile-stat-label">Likes Received</span>
                            </div>
                            <div class="profile-stat">
                                <span class="profile-stat-number" id="userCommentsCount">0</span>
                                <span class="profile-stat-label">Comments Made</span>
                            </div>
                        </div>

                        <div class="profile-section">
                            <h3>Account Actions</h3>
                            <div class="profile-actions">
                                <button class="btn btn-primary" onclick="window.posts.loadPosts('my-posts'); window.navigation.showView('home');">
                                    <i class="fas fa-eye"></i> View My Posts
                                </button>
                                <button class="btn btn-outline" onclick="window.posts.loadPosts('liked'); window.navigation.showView('home');">
                                    <i class="fas fa-heart"></i> View Liked Posts
                                </button>
                                <button class="btn btn-secondary" onclick="window.auth.logout();">
                                    <i class="fas fa-sign-out-alt"></i> Logout
                                </button>
                            </div>
                        </div>

                        <div class="profile-section">
                            <h3>Recent Activity</h3>
                            <div id="recentActivity">
                                <p style="color: #666; text-align: center; padding: 20px;">
                                    <i class="fas fa-clock"></i> Recent activity will be displayed here
                                </p>
                            </div>
                        </div>
                    </section>
                </main>

                    <!-- Sidebar -->
                    <aside class="sidebar">
                        <div class="sidebar-section">
                            <h3>Categories</h3>
                            <div id="categoriesList" class="categories-list">
                                <!-- Categories will be loaded here -->
                            </div>
                        </div>

                        <div class="sidebar-section">
                            <h3>Quick Stats</h3>
                            <div class="stats">
                                <div class="stat-item">
                                    <span class="stat-number" id="totalPosts">0</span>
                                    <span class="stat-label">Posts</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-number" id="totalUsers">0</span>
                                    <span class="stat-label">Users</span>
                                </div>
                            </div>
                        </div>
                    </aside>
                </div>
            </div>
        </div>

        <!-- Categories Page -->
        <div id="categoriesPage" class="page">
            <div class="container">
                <div class="page-header">
                    <h1>Categories</h1>
                    <button class="btn btn-primary" id="createCategoryBtn" style="display: none;">
                        <i class="fas fa-plus"></i> New Category
                    </button>
                </div>
                <div id="categoriesGrid" class="categories-grid">
                    <!-- Categories will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Trending Page -->
        <div id="trendingPage" class="page">
            <div class="container">
                <div class="page-header">
                    <h1>Trending Posts</h1>
                </div>
                <div id="trendingPosts" class="posts-container">
                    <!-- Trending posts will be loaded here -->
                </div>
            </div>
        </div>
    </main>

    <!-- Modals -->
    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Login</h2>
                <button class="modal-close">&times;</button>
            </div>
            <form id="loginForm" class="auth-form">
                <div class="form-group">
                    <label for="loginEmail">Email</label>
                    <input type="email" id="loginEmail" required>
                </div>
                <div class="form-group">
                    <label for="loginPassword">Password</label>
                    <input type="password" id="loginPassword" required>
                </div>
                <button type="submit" class="btn btn-primary btn-full">Login</button>
                <div class="form-footer">
                    <p>Don't have an account? <a href="#" id="switchToRegister">Register here</a></p>
                </div>
            </form>
        </div>
    </div>

    <!-- Register Modal -->
    <div id="registerModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Register</h2>
                <button class="modal-close">&times;</button>
            </div>
            <form id="registerForm" class="auth-form">
                <div class="form-group">
                    <label for="registerUsername">Username</label>
                    <input type="text" id="registerUsername" required>
                </div>
                <div class="form-group">
                    <label for="registerEmail">Email</label>
                    <input type="email" id="registerEmail" required>
                </div>
                <div class="form-group">
                    <label for="registerPassword">Password</label>
                    <input type="password" id="registerPassword" required>
                </div>
                <div class="form-group">
                    <label for="registerAvatar">Profile Avatar (Optional)</label>
                    <div class="avatar-upload-container">
                        <div class="avatar-preview" id="avatarPreview">
                            <i class="fas fa-user"></i>
                            <span class="avatar-text">No image selected</span>
                        </div>
                        <input type="file" id="registerAvatar" accept="image/*" class="avatar-input">
                        <label for="registerAvatar" class="avatar-upload-btn">
                            <i class="fas fa-camera"></i> Choose Avatar
                        </label>
                        <button type="button" class="avatar-remove-btn" id="removeAvatarBtn" style="display: none;">
                            <i class="fas fa-times"></i> Remove
                        </button>
                    </div>
                    <small class="form-help">Supported formats: JPG, PNG, GIF. Max size: 2MB</small>
                </div>
                <button type="submit" class="btn btn-primary btn-full">Register</button>
                <div class="form-footer">
                    <p>Already have an account? <a href="#" id="switchToLogin">Login here</a></p>
                </div>
            </form>
        </div>
    </div>

    <!-- Create Post Modal -->
    <div id="createPostModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2><i class="fas fa-edit"></i> Create New Post</h2>
                <button class="modal-close">&times;</button>
            </div>
            <form id="createPostForm" class="create-post-form">
                <div class="form-row">
                    <div class="form-group form-group-flex-2">
                        <label for="postTitle">
                            <i class="fas fa-heading"></i> Post Title
                        </label>
                        <input type="text" id="postTitle" placeholder="Enter an engaging title for your post..." required>
                        <div class="form-help">
                            <span class="char-counter" id="titleCounter">0/100</span>
                        </div>
                    </div>
                    <div class="form-group form-group-flex-1">
                        <label for="postCategory">
                            <i class="fas fa-tags"></i> Category
                        </label>
                        <div class="select-wrapper">
                            <select id="postCategory">
                                <option value="">Choose category...</option>
                            </select>
                            <i class="fas fa-chevron-down select-arrow"></i>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="postContent">
                        <i class="fas fa-align-left"></i> Content
                    </label>
                    <div class="textarea-wrapper">
                        <textarea id="postContent" rows="8" placeholder="Share your thoughts, ideas, or questions with the community..." required></textarea>
                        <div class="textarea-toolbar">
                            <div class="toolbar-left">
                                <button type="button" class="toolbar-btn" title="Bold" data-format="bold">
                                    <i class="fas fa-bold"></i>
                                </button>
                                <button type="button" class="toolbar-btn" title="Italic" data-format="italic">
                                    <i class="fas fa-italic"></i>
                                </button>
                                <button type="button" class="toolbar-btn" title="Link" data-format="link">
                                    <i class="fas fa-link"></i>
                                </button>
                                <button type="button" class="toolbar-btn" title="Code" data-format="code">
                                    <i class="fas fa-code"></i>
                                </button>
                            </div>
                            <div class="toolbar-right">
                                <span class="char-counter" id="contentCounter">0/5000</span>
                            </div>
                        </div>
                    </div>
                    <div class="form-help">
                        <i class="fas fa-info-circle"></i>
                        You can use basic formatting. Be respectful and follow community guidelines.
                    </div>
                </div>

                <div class="form-group">
                    <label>
                        <i class="fas fa-hashtag"></i> Tags (Optional)
                    </label>
                    <div class="tags-input-wrapper">
                        <div class="tags-container" id="tagsContainer">
                            <input type="text" id="tagsInput" placeholder="Add tags to help others find your post..." class="tags-input">
                        </div>
                    </div>
                    <div class="form-help">
                        <i class="fas fa-lightbulb"></i>
                        Press Enter or comma to add tags. Use relevant keywords.
                    </div>
                </div>

                <div class="form-actions">
                    <div class="form-actions-left">
                        <label class="checkbox-wrapper">
                            <input type="checkbox" id="postDraft">
                            <span class="checkmark"></span>
                            Save as draft
                        </label>
                    </div>
                    <div class="form-actions-right">
                        <button type="button" class="btn btn-secondary" onclick="window.modal.close()">
                            <i class="fas fa-times"></i> Cancel
                        </button>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-paper-plane"></i> Publish Post
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- Create Category Modal -->
    <div id="createCategoryModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Create New Category</h2>
                <button class="modal-close">&times;</button>
            </div>
            <form id="createCategoryForm">
                <div class="form-group">
                    <label for="categoryName">Category Name</label>
                    <input type="text" id="categoryName" required>
                </div>
                <button type="submit" class="btn btn-primary btn-full">Create Category</button>
            </form>
        </div>
    </div>

    <!-- Post Detail Modal -->
    <div id="postDetailModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2>Post Details</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div id="postDetailContent">
                <!-- Post details and comments will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- Scripts -->
    <script src="js/utils.js?v=8.9"></script>
    <script src="js/api.js?v=8.9"></script>
    <script src="js/auth.js?v=8.9"></script>
    <script src="js/posts.js?v=8.9"></script>
    <script src="js/app.js?v=8.9"></script>
</body>
</html>
